<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shopping Cart</title>
    <link rel="stylesheet" href="./css/all.min.css" />
    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <link rel="stylesheet" href="./css/Cart.css " />
    <script src="./js/all.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>

    <script type="module">
      import { LocalStorageManager, CartRenderer } from "./js/cart.js";

      window.addEventListener("DOMContentLoaded", () => {
        const storageManager = new LocalStorageManager();
        const cartRenderer = new CartRenderer(storageManager);

        // Initial render
        cartRenderer.renderCartItems();

        // Shipping mode selection
        const shippingModes = document.querySelectorAll(".shipping-mode");
        shippingModes.forEach((mode) => {
          mode.addEventListener("change", () => {
            cartRenderer.updateCartTotals();
          });

          // Go back button in history

          document.querySelector(".goBack").addEventListener("click", () => {
            window.history.back();
          });
        });

        // Set default shipping mode
        document.getElementById("shipping-mode-1").checked = true;
      });
    </script>
  </head>
  <body>
    <div class="container-fluid Cart-Special-BG">
      <div
        class="container-fluid border rounded bg-light d-flex flex-column p-2"
      >
        <!-- Header -->
        <div class="container mt-2">
          <div class="row align-items-center">
            <div class="col-12 col-sm-6 text-center text-sm-start">
              <img
                src="./img/logo.png"
                alt="logo"
                class="img-fluid"
                style="max-width: 120px"
              />
            </div>
            <div
              class="col-12 col-sm-6 d-flex justify-content-md-end justify-content-center"
            >
              <button class="btn btn-outline-secondary btn-sm rounded goBack">
                <i class="fa-solid fa-arrow-left me-1"></i> Continue Shopping
              </button>
            </div>
          </div>
        </div>
        <!--End Header-->

        <!-- warning message -->
        <div class="warning-max"></div>
        <!-- End warning message -->

        <!-- Desktop Table (shown above 480px) -->
        <div class="cart-item-desktop">
          <div class="container mt-3">
            <table class="table table-hover align-middle">
              <thead class="table-light">
                <tr>
                  <th class="text-uppercase text-black-50">Product</th>
                  <th class="text-uppercase text-black-50 text-center">
                    Price
                  </th>
                  <th class="text-uppercase text-black-50 text-center">
                    Quantity
                  </th>
                  <th class="text-uppercase text-black-50 text-center">
                    Total
                  </th>
                  <th class="text-uppercase text-black-50 text-center">
                    Action
                  </th>
                </tr>
              </thead>
              <tbody id="cart-table-body">
                <!-- Cart items will be dynamically inserted here -->
              </tbody>
            </table>
          </div>
        </div>
        <!-- End Desktop Table -->

        <!-- Mobile List (shown below 480px) -->
        <div class="cart-item-mobile">
          <div class="container mt-3" id="cart-mobile-list">
            <!-- Cart items will be dynamically inserted here -->
          </div>
        </div>
        <!-- End Mobile List -->

        <!-- Footer of Cart Page -->
        <div class="container my-3 p-3 rounded-3 bg-Cart-Footer border">
          <div class="row">
            <!-- shipping-mode -->
            <div class="col-12 col-md-8">
              <h4 class="fw-bold">Choose shipping mode:</h4>
              <div class="mt-3">
                <div class="form-check">
                  <input
                    class="form-check-input shipping-mode"
                    type="radio"
                    name="shipping-mode"
                    id="shipping-mode-1"
                    checked
                  />
                  <label class="form-check-label" for="shipping-mode-1">
                    Store pickup (In 20 min) • FREE
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input shipping-mode"
                    type="radio"
                    name="shipping-mode"
                    id="shipping-mode-2"
                  />
                  <label class="form-check-label" for="shipping-mode-2">
                    Delivery at home • 9.90$
                  </label>
                </div>
              </div>
            </div>
            <!-- End shipping-mode -->

            <div class="col-12 col-md-4 mt-3 mt-md-0">
              <!-- subtotal -->
              <div class="d-flex justify-content-between">
                <p class="text-black-50 text-uppercase mb-2">Subtotal:</p>
                <span class="fw-bold subtotal-amount">0.00 $</span>
              </div>

              <!-- shipping fees -->
              <div class="d-flex justify-content-between">
                <p class="text-black-50 text-uppercase mb-2">Shipping:</p>
                <span class="fw-bold shipping-amount">FREE</span>
              </div>

              <!-- line break -->
              <hr class="my-2" />

              <!-- total -->
              <div class="d-flex justify-content-between">
                <p class="text-black-50 text-uppercase mb-2">Total:</p>
                <span class="fw-bold fs-5 grand-total-amount">0.00 $</span>
              </div>

              <!-- checkout button -->
              <button class="btn btn-danger w-100 mt-3 text-uppercase py-2">
                Proceed to Checkout
              </button>
            </div>
          </div>
        </div>
        <!-- End Footer of Cart Page -->
      </div>
    </div>
  </body>
</html>
